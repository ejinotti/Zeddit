<%
if logged_in?
  up_action = upvote_url("Post", post.id)
  down_action = downvote_url("Post", post.id)
  method = "POST"
else
  up_action = down_action = new_session_url
  method = "GET"
end

vote_val = current_user.get_vote_value(post.id, "Post")
%>


<form class="vote" action="<%= up_action %>" method="<%= method %>">
  <%= token_tag form_authenticity_token if method == "POST" %>
  <button <%= 'style=background:red' if vote_val == 1 %>>&#8593;</button>
</form>

<a href="<%= sub_post_url(post.sub_id, post.id) %>"><%= post.title %></a>
<small>(<%= post.points %> points)</small> vote_val <%= vote_val %><br>


<form class="vote" action="<%= down_action %>" method="<%= method %>">
  <%= token_tag form_authenticity_token if method == "POST" %>
  <button <%= 'style=background:red' if vote_val == -1 %>>&#8595;</button>
</form>

<small>
  submitted at <%= post.created_at %>
  by <a href="<%= user_url(post.author_id) %>"><%= post.author.username %></a>
  <% if show_sub %>
    to <a href="<%= sub_url(post.sub_id) %>"><%= post.sub.title %></a>
  <% end %>
  <br>
</small>

<a href="<%= sub_post_url(post.sub_id, post.id) %>">
  <%= post.comments.count %> comments
</a>
<br><br>
